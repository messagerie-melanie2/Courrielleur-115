<?xml version="1.0"?>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->

<?xml-stylesheet href="chrome://messenger/skin/icons.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/folderMenus.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/accountManage.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/openpgp/inlineNotification.css" type="text/css"?>

<!DOCTYPE html [
<!ENTITY % identityEditDTD SYSTEM "chrome://messenger/locale/am-identity-edit.dtd" >
%identityEditDTD;
<!ENTITY % identityDTD SYSTEM "chrome://messenger/locale/am-main.dtd" >
%identityDTD;
<!ENTITY % copiesDTD SYSTEM "chrome://messenger/locale/am-copies.dtd">
%copiesDTD;
<!ENTITY % addressingDTD SYSTEM "chrome://messenger/locale/am-addressing.dtd" >
%addressingDTD;
<!ENTITY % e2eDTD SYSTEM "chrome://messenger/locale/am-smime.dtd" >
%e2eDTD;
]>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
      xmlns:html="http://www.w3.org/1999/xhtml"
      scrolling="false"
      style="height: 900px; min-width: 800px;">
<head>
  <title><!-- identityDialogTitleEdit --></title>
  <script defer="defer" src="chrome://messenger/content/globalOverlay.js"></script>
  <script defer="defer" src="chrome://global/content/editMenuOverlay.js"></script>
  <script defer="defer" src="chrome://global/content/preferencesBindings.js"></script>
  <script defer="defer" src="chrome://messenger/content/am-prefs.js"></script>
  <script defer="defer" src="chrome://messenger/content/amUtils.js"></script>
  <script defer="defer" src="chrome://messenger/content/am-copies.js"></script>
  <script defer="defer" src="chrome://messenger/content/am-addressing.js"></script>
  <script defer="defer" src="chrome://messenger/content/am-e2e.js"></script>
  <script defer="defer" src="chrome://messenger/content/am-identity-edit.js"></script>
  <script>
    // NOTE: am-identity-edit.js is not only used for this page.
    window.addEventListener("DOMContentLoaded", onLoadIdentityProperties);
  </script>
</head>
<html:body xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
<dialog id="identityDialog">
  <stringbundle id="bundle_prefs"
                src="chrome://messenger/locale/prefs.properties"/>
  <stringbundle id="bundle_messenger"
                src="chrome://messenger/locale/messenger.properties"/>

  <tabbox flex="1" style="overflow: hidden;">
    <tabs id="identitySettings">
      <tab id="identitySettingsTab" label="&settingsTab.label;"/>
      <tab id="identityCopiesFoldersTab" label="&copiesFoldersTab.label;"/>
      <tab id="identityAddressingTab" label="&addressingTab.label;"/>
      <tab id="identityE2ETab" label="&e2eTitle.label;"/>
    </tabs>

    <tabpanels id="identityTabsPanels" flex="1">
      <!-- Identity Settings Tab -->
      <vbox flex="1" name="settings">
        <html:div>
        <html:fieldset>
          <html:legend>&publicData.label;</html:legend>
          <html:table class="identity-table">
            <html:tr>
              <html:th>
                <label id="identity.fullName.label"
                       value="&name.label;"
                       control="identity.fullName"
                       accesskey="&name.accesskey;"/>
              </html:th>
              <html:td>
                <html:input id="identity.fullName"
                            type="text"
                            class="input-inline"
                            aria-labelledby="identity.fullName.label"
                            size="30"/>
              </html:td>
            </html:tr>
            <html:tr>
              <html:th>
                <label id="identity.email.label"
                       value="&email.label;"
                       control="identity.email"
                       accesskey="&email.accesskey;"/>
              </html:th>
              <html:td>
                <html:input id="identity.email"
                            type="email"
                            class="uri-element input-inline"
                            aria-labelledby="identity.email.label"/>

              </html:td>
            </html:tr>
            <html:tr>
              <html:th>
                <label id="identity.replyTo.label"
                       value="&replyTo.label;"
                       accesskey="&replyTo.accesskey;"
                       control="identity.replyTo"/>
              </html:th>
              <html:td>
                <html:input id="identity.replyTo"
                            type="text"
                            class="uri-element input-inline"
                            placeholder="&replyTo.placeholder;"
                            aria-labelledby="identity.replyTo.label"/>
              </html:td>
            </html:tr>
            <html:tr>
              <html:th>
                <label id="identity.organization.label"
                       value="&organization.label;"
                       control="identity.organization"
                       accesskey="&organization.accesskey;"/>
              </html:th>
              <html:td>
                <html:input id="identity.organization"
                            type="text"
                            class="input-inline"
                            aria-labelledby="identity.organization.label"/>
              </html:td>
            </html:tr>
            <html:tr>
              <html:th>
                <label value="&signatureText.label;" control="identity.htmlSigText"
                       accesskey="&signatureText.accesskey;"/>
              </html:th>
              <html:td style="width:100%;">
                <checkbox id="identity.htmlSigFormat" label="&signatureHtml.label;"
                          accesskey="&signatureHtml.accesskey;" style="width:100%;"/>
              </html:td>
            </html:tr>
          </html:table>

          <separator class="thin"/>

          <hbox class="indent input-container" flex="1">
            <html:textarea id="identity.htmlSigText" style="flex-grow: 1;" rows="4" class="signatureBox"/>
          </hbox>

          <hbox align="center">
            <checkbox id="identity.attachSignature" label="&signatureFile.label;"
                      flex="1" accesskey="&signatureFile.accesskey;"
                      oncommand="setupSignatureItems();"/>
          </hbox>

          <hbox align="center" class="indent input-container">
            <html:input id="identity.signature"
                        type="text"
                        datatype="nsIFile"
                        name="identity.signature"
                        aria-labelledby="identity.attachSignature"
                        class="uri-element input-inline"/>
            <button id="identity.sigbrowsebutton" class="push"
                    label="&choose.label;" accesskey="&choose.accesskey;"
                    oncommand="selectFile()"/>
          </hbox>

          <hbox align="center">
            <checkbox id="identity.attachVCard" label="&attachVCard.label;"
                      flex="1" accesskey="&attachVCard.accesskey;"/>
            <button class="push" label="&editVCard.label;"
                    accesskey="&editVCard.accesskey;" oncommand="editVCard()"/>
            <label id="identity.escapedVCard" hidden="true"/>
          </hbox>
        </html:fieldset>
        </html:div>

        <html:div>
        <html:fieldset>
          <html:legend>&privateData.label;</html:legend>

          <hbox id="identityCatchAllBox" align="center" class="input-container">
            <checkbox id="identity.catchAll"
                      label="&catchAll.label;"
                      accesskey="&catchAll.accesskey;"
                      style="margin-block:auto;"/>
            <html:input id="identity.catchAllHint"
                        type="text"
                        oninput="handleInputCatchAllHint(event);"
                        placeholder="list@example.com, *@example.com"
                        class="input-inline"
                        aria-labelledby="identity.catchAll"/>
          </hbox>

          <separator class="thin"/>

          <label value="&smtpName.label;"
                 control="identity.smtpServerKey"
                 accesskey="&smtpName.accesskey;"/>
          <hbox align="center">
            <menulist id="identity.smtpServerKey" flex="1">
              <menupopup id="smtpPopup">
                <menuitem id="useDefaultItem" value=""
                          label="&smtpDefaultServer.label;"/>
                <menuseparator/>
                <!-- list will be inserted here -->
              </menupopup>
            </menulist>

            <button id="editSmtp"
                    label="&smtpServerEdit.label;"
                    accesskey="&smtpServerEdit.accesskey;"
                    oncommand="editCurrentSMTP();"/>
          </hbox>

          <separator class="thin"/>

          <hbox align="center" class="input-container">
            <label id="identity.input.label" value="&identityAlias.label;"
                   accesskey="&identityAlias.accesskey;"
                   style="margin-block: auto;"
                   control="identity.label"/>
            <html:input id="identity.label"
                        type="text"
                        class="input-inline"
                        aria-labelledby="identity.input.label"/>
          </hbox>
        </html:fieldset>
        </html:div>

      </vbox>

      <!-- Copies & Folders Tab -->

  <vbox id="copiesAndFolders" flex="1">

  <linkset>
    <html:link rel="localization" href="messenger/preferences/am-copies.ftl"/>
  </linkset>

  <stringbundle id="bundle_messenger" src="chrome://messenger/locale/messenger.properties"/>

    <label id="identity.fccFolder" hidden="true" wsm_persist="true"
           pref="true" preftype="string" prefattribute="value"
           prefstring="mail.identity.%identitykey%.fcc_folder"/>
    <label id="identity.draftFolder" hidden="true" wsm_persist="true"
           pref="true" preftype="string" prefattribute="value"
           prefstring="mail.identity.%identitykey%.draft_folder"/>
    <label id="identity.archiveFolder" hidden="true" wsm_persist="true"
           pref="true" preftype="string" prefattribute="value"
           prefstring="mail.identity.%identitykey%.archive_folder"/>
    <label id="identity.stationeryFolder" hidden="true" wsm_persist="true"
           pref="true" preftype="string" prefattribute="value"
           prefstring="mail.identity.%identitykey%.stationary_folder"/>
    <label id="identity.email" hidden="true" wsm_persist="true"/>
    <label id="identity.fccFolderPickerMode" hidden="true" wsm_persist="true"
           pref="true" preftype="int" prefattribute="value"
           prefstring="mail.identity.%identitykey%.fcc_folder_picker_mode"/>
    <label id="identity.draftsFolderPickerMode" hidden="true" wsm_persist="true"
           pref="true" preftype="int" prefattribute="value"
           prefstring="mail.identity.%identitykey%.drafts_folder_picker_mode"/>
    <label id="identity.archivesFolderPickerMode" hidden="true" wsm_persist="true"
           pref="true" preftype="int" prefattribute="value"
           prefstring="mail.identity.%identitykey%.archives_folder_picker_mode"/>
    <label id="identity.tmplFolderPickerMode" hidden="true" wsm_persist="true"
           pref="true" preftype="int" prefattribute="value"
           prefstring="mail.identity.%identitykey%.tmpl_folder_picker_mode"/>
    <html:div>
    <html:fieldset id="copiesGroup">
      <html:legend>&sendingPrefix.label;</html:legend>

      <hbox align="center">
        <checkbox id="identity.doFcc" wsm_persist="true" label="&fccMailFolder.label;"
                  accesskey="&fccMailFolder.accesskey;"
                  prefattribute="value"
                  prefstring="mail.identity.%identitykey%.fcc"
                  oncommand="setupFccItems();"/>
      </hbox>
        <radiogroup id="doFcc" aria-labelledby="identity.doFcc">
        <hbox class="specialFolderPickerGrid">
          <vbox>
            <hbox flex="1" align="center">
              <radio id="fcc_selectAccount"
                     class="depends-on-do-fcc"
                     value="0" label="&sentFolderOn.label;"
                     accesskey="&sentFolderOn.accesskey;"
                     oncommand="setPickersState('msgFccAccountPicker', 'msgFccFolderPicker', event)"/>
            </hbox>
            <hbox flex="1" align="center">
              <radio id="fcc_selectFolder"
                     class="depends-on-do-fcc"
                     value="1" label="&sentInOtherFolder.label;"
                     accesskey="&sentInOtherFolder.accesskey;"
                     oncommand="setPickersState('msgFccFolderPicker', 'msgFccAccountPicker', event)"/>
            </hbox>
          </vbox>
          <vbox flex="1">
             <menulist id="msgFccAccountPicker"
                       class="folderMenuItem depends-on-do-fcc"
                       aria-labelledby="fcc_selectAccount">
                <menupopup is="folder-menupopup" id="msgFccAccountPopup"
                           mode="filing"
                           expandFolders="false"
                           oncommand="noteSelectionChange('fcc', 'Account', event)"/>
              </menulist>
              <menulist id="msgFccFolderPicker"
                        class="folderMenuItem depends-on-do-fcc"
                        aria-labelledby="fcc_selectFolder"
                        displayformat="verbose">
                <menupopup is="folder-menupopup" id="msgFccFolderPopup"
                           mode="filing"
                           class="menulist-menupopup"
                           showFileHereLabel="true"
                           oncommand="noteSelectionChange('fcc', 'Folder', event)"/>
              </menulist>
          </vbox>
        </hbox>
      </radiogroup>

      <hbox align="center" class="fccReplyFollowsParent" hidable="true" hidefor="nntp,rss">
        <checkbox id="identity.fccReplyFollowsParent" wsm_persist="true"
                  class="depends-on-do-fcc"
                  label="&fccReplyFollowsParent.label;"
                  accesskey="&fccReplyFollowsParent.accesskey;"
                  prefattribute="value"
                  prefstring="mail.identity.%identitykey%.fcc_reply_follows_parent"/>
      </hbox>

      <separator class="thin"/>

      <hbox>
        <vbox>
          <hbox flex="1" align="center">
            <checkbox id="identity.doCc" wsm_persist="true" label="&ccAddress.label;"
                      accesskey="&ccAddress.accesskey;"
                      control="identity.doCcList"
                      oncommand="identityDoCcBccOnCommand(event);"
                      prefattribute="value"
                      prefstring="mail.identity.%identitykey%.doCc"/>
          </hbox>
          <hbox flex="1" align="center">
            <checkbox id="identity.doBcc" wsm_persist="true" label="&bccAddress.label;"
                      accesskey="&bccAddress.accesskey;"
                      control="identity.doBccList"
                      oncommand="identityDoCcBccOnCommand(event);"
                      prefattribute="value"
                      prefstring="mail.identity.%identitykey%.doBcc"/>
          </hbox>
        </vbox>
        <vbox flex="1">
          <hbox flex="1" class="input-container" align="center">
            <html:input id="identity.doCcList" wsm_persist="true"
                        type="text"
                        aria-labelledby="identity.doCc"
                        prefstring="mail.identity.%identitykey%.doCcList"
                        class="uri-element input-inline"
                        placeholder="&ccAddressList.placeholder;"
                        onblur="identityDoCcBccOnBlur(event);"/>
          </hbox>
          <hbox flex="1" class="input-container" align="center">
            <html:input id="identity.doBccList" wsm_persist="true"
                        type="text"
                        aria-labelledby="identity.doBcc"
                        prefstring="mail.identity.%identitykey%.doBccList"
                        class="uri-element input-inline"
                        placeholder="&bccAddressList.placeholder;"
                        onblur="identityDoCcBccOnBlur(event);"/>
          </hbox>
        </vbox>
      </hbox>
      <description class="indent tip-caption"
                   data-l10n-id="account-prefs-show-address-row-description"/>
    </html:fieldset>
    </html:div>

    <html:div>
    <html:fieldset id="archivesGroup">
      <html:legend>&archivesTitle.label;</html:legend>

      <hbox pack="start">
        <checkbox id="identity.archiveEnabled" wsm_persist="true"
                  label="&keepArchives.label;"
                  accesskey="&keepArchives.accesskey;"
                  prefattribute="value"
                  prefstring="mail.identity.%identitykey%.archive_enabled"
                  oncommand="setupArchiveItems();"/>
      </hbox>

      <radiogroup id="messageArchives">
        <hbox class="specialFolderPickerGrid">
          <vbox>
            <hbox flex="1" align="center">
              <radio id="archive_selectAccount"
                     class="depends-on-archive"
                     value="0" label="&archivesFolderOn.label;"
                     accesskey="&archivesFolderOn.accesskey;"
                     oncommand="setPickersState('msgArchivesAccountPicker', 'msgArchivesFolderPicker', event)"/>
            </hbox>
            <hbox flex="1" align="center">
              <radio id="archive_selectFolder"
                     class="depends-on-archive"
                     value="1" label="&archiveInOtherFolder.label;"
                     accesskey="&archiveInOtherFolder.accesskey;"
                     oncommand="setPickersState('msgArchivesFolderPicker', 'msgArchivesAccountPicker', event)"/>
            </hbox>
          </vbox>
          <vbox flex="1">
            <menulist id="msgArchivesAccountPicker"
                      class="folderMenuItem depends-on-archive"
                      aria-labelledby="archive_selectAccount">
              <menupopup is="folder-menupopup" id="msgArchivesAccountPopup"
                         mode="filing"
                         expandFolders="false"
                         oncommand="noteSelectionChange('archive', 'Account', event)"/>
            </menulist>
            <menulist id="msgArchivesFolderPicker"
                      class="folderMenuItem depends-on-archive"
                      aria-labelledby="archive_selectFolder"
                      displayformat="verbose">
              <menupopup is="folder-menupopup" id="msgArchivesFolderPopup"
                         mode="filing"
                         class="menulist-menupopup"
                         showFileHereLabel="true"
                         oncommand="noteSelectionChange('archive', 'Folder', event)"/>
            </menulist>
          </vbox>
        </hbox>
      </radiogroup>
      <hbox pack="end">
        <button id="archiveHierarchyButton"
                class="depends-on-archive"
                label="&archiveHierarchyButton.label;"
                accesskey="&archiveHierarchyButton.accesskey;"
                oncommand="ChangeArchiveHierarchy();"/>
      </hbox>
    </html:fieldset>
    </html:div>

    <html:div>
    <html:fieldset id="foldersGroup">
      <html:legend>&specialFolders.label;</html:legend>

      <hbox align="center">
        <label value="&keepDrafts2.label;" control="messageDrafts"/>
      </hbox>

      <radiogroup id="messageDrafts">
        <hbox class="specialFolderPickerGrid">
          <vbox>
            <hbox flex="1" align="center">
              <radio id="draft_selectAccount"
                     oncommand="setPickersState('msgDraftsAccountPicker', 'msgDraftsFolderPicker', event)"
                     value="0" label="&draftsFolderOn.label;"
                     accesskey="&draftsFolderOn.accesskey;"/>
            </hbox>
            <hbox flex="1" align="center">
              <radio id="draft_selectFolder"
                     oncommand="setPickersState('msgDraftsFolderPicker', 'msgDraftsAccountPicker', event)"
                     value="1" label="&draftInOtherFolder.label;"
                     accesskey="&draftInOtherFolder.accesskey;"/>
            </hbox>
          </vbox>
          <vbox flex="1">
            <menulist id="msgDraftsAccountPicker"
                      class="folderMenuItem"
                      aria-labelledby="draft_selectAccount">
              <menupopup is="folder-menupopup" id="msgDraftAccountPopup"
                         mode="filing"
                         expandFolders="false"
                         oncommand="noteSelectionChange('draft', 'Account', event)"/>
            </menulist>
            <menulist id="msgDraftsFolderPicker"
                      class="folderMenuItem"
                      aria-labelledby="draft_selectFolder"
                      displayformat="verbose">
              <menupopup is="folder-menupopup" id="msgDraftFolderPopup"
                         mode="filing"
                         class="menulist-menupopup"
                         showFileHereLabel="true"
                         oncommand="noteSelectionChange('draft', 'Folder', event)"/>
            </menulist>
          </vbox>
        </hbox>
      </radiogroup>

      <separator class="thin"/>

      <hbox align="center">
        <label value="&keepTemplates.label;" control="messageTemplates"/>
      </hbox>

      <radiogroup id="messageTemplates">
        <hbox class="specialFolderPickerGrid">
          <vbox>
            <hbox flex="1" align="center">
              <radio id="tmpl_selectAccount"
                     oncommand="setPickersState('msgStationeryAccountPicker', 'msgStationeryFolderPicker', event)"
                     value="0" label="&templatesFolderOn.label;"
                     accesskey="&templatesFolderOn.accesskey;"/>
            </hbox>
            <hbox flex="1" align="center">
              <radio id="tmpl_selectFolder"
                     oncommand="setPickersState('msgStationeryFolderPicker', 'msgStationeryAccountPicker', event)"
                     value="1" label="&templateInOtherFolder.label;"
                     accesskey="&templateInOtherFolder.accesskey;"/>
            </hbox>
          </vbox>
          <vbox flex="1">
            <menulist id="msgStationeryAccountPicker"
                        class="folderMenuItem"
                        aria-labelledby="tmpl_selectAccount">
              <menupopup is="folder-menupopup" id="msgFccAccountPopup"
                         mode="filing"
                         expandFolders="false"
                         oncommand="noteSelectionChange('tmpl', 'Account', event)"/>
            </menulist>
            <menulist id="msgStationeryFolderPicker"
                        class="folderMenuItem"
                        aria-labelledby="tmpl_selectFolder"
                        displayformat="verbose">
              <menupopup is="folder-menupopup" id="msgTemplFolderPopup"
                         mode="filing"
                         class="menulist-menupopup"
                         showFileHereLabel="true"
                         oncommand="noteSelectionChange('tmpl', 'Folder', event)"/>
            </menulist>
          </vbox>
        </hbox>
      </radiogroup>
      <hbox align="center">
        <checkbox id="identity.showSaveMsgDlg" wsm_persist="true" label="&saveMessageDlg.label;"
                  accesskey="&saveMessageDlg.accesskey;"
                  prefattribute="value"
                  prefstring="mail.identity.%identitykey%.showSaveMsgDlg"/>
      </hbox>
    </html:fieldset>
    </html:div>
  </vbox>

      <!-- Composition & Addressing Tab -->

    <vbox flex="1" id="compositionAndAddressing">
      <stringbundle id="bundle_addressBook" src="chrome://messenger/locale/addressbook/addressBook.properties"/>

      <html:div>
      <html:fieldset>
        <html:legend>&compositionGroupTitle.label;</html:legend>
        <hbox align="center">
          <checkbox wsm_persist="true" id="identity.composeHtml" label="&useHtml.label;"
                    accesskey="&useHtml.accesskey;"
                    prefattribute="value"
                    prefstring="mail.identity.%identitykey%.compose_html"/>
        </hbox>

        <separator class="thin"/>

        <hbox align="center">
          <checkbox wsm_persist="true" id="identity.autoQuote" label="&autoQuote.label;"
                    accesskey="&autoQuote.accesskey;"
                    pref="true" preftype="bool" prefattribute="value"
                    prefstring="mail.identity.%identitykey%.auto_quote"/>
        </hbox>
        <hbox align="center">
          <label value="&quoting.label;" accesskey="&quoting.accesskey;" control="identity.replyOnTop"/>
          <menulist wsm_persist="true" id="identity.replyOnTop" oncommand="quoteEnabling();"
                    pref="true" preftype="int" prefattribute="value"
                    prefstring="mail.identity.%identitykey%.reply_on_top">
            <menupopup>
              <menuitem value="1" label="&aboveQuote.label;"/>
              <menuitem value="0" label="&belowQuote.label;"/>
              <menuitem value="2" label="&selectAndQuote.label;"/>
            </menupopup>
          </menulist>
        </hbox>
        <hbox class="indent" align="center" id="placeBox">
          <label value="&place.label;" accesskey="&place.accesskey;" control="identity.sig_bottom"/>
          <menulist wsm_persist="true" id="identity.sig_bottom" genericattr="true"
                    pref="true" preftype="bool" prefattribute="value"
                    prefstring="mail.identity.%identitykey%.sig_bottom">
            <menupopup>
              <menuitem value="true" label="&belowText.label;"/>
              <menuitem value="false" label="&aboveText.label;"/>
            </menupopup>
          </menulist>
        </hbox>

        <checkbox id="identity.sig_on_reply" wsm_persist="true"
                  label="&includeSigOnReply.label;"
                  accesskey="&includeSigOnReply.accesskey;"
                  preftype="bool" genericattr="true"
                  prefstring="mail.identity.%identitykey%.sig_on_reply"/>

        <checkbox id="identity.sig_on_fwd" wsm_persist="true"
                  label="&includeSigOnForward.label;"
                  accesskey="&includeSigOnForward.accesskey;"
                  preftype="bool" genericattr="true"
                  prefstring="mail.identity.%identitykey%.sig_on_fwd"/>

        <separator class="thin"/>

        <hbox pack="end">
          <button id="globalComposingPrefsLink"
                  label="&globalComposingPrefs.label;"
                  accesskey="&globalComposingPrefs.accesskey;"
                  oncommand="showGlobalComposingPrefs();"/>
        </hbox>
      </html:fieldset>
      </html:div>

      <separator class="thin"/>

      <html:div>
      <html:fieldset>
        <html:legend>&addressingGroupTitle.label;</html:legend>

        <label control="identity.overrideGlobal_Pref">&addressingText.label;</label>
        <radiogroup id="identity.overrideGlobal_Pref" class="indent"
                    oncommand="LDAPenabling();" wsm_persist="true"
                    genericattr="true" preftype="bool"
                    prefstring="mail.identity.%identitykey%.overrideGlobal_Pref">
          <radio value="false" label="&useGlobal.label;"
                 accesskey="&useGlobal.accesskey;"/>
          <radio value="true" id="directories" label="&directories.label;"
                 accesskey="&directories.accesskey;"/>
          <hbox class="indent">
            <menulist is="menulist-addrbooks" id="identity.directoryServer"
                      none="&directoriesNone.label;"
                      remoteonly="true"
                      wsm_persist="true"
                      preftype="string"
                      prefstring="mail.identity.%identitykey%.directoryServer"
                      style="min-width: 16em;"
                      aria-labelledby="directories"
                      flex="1"/>
            <button id="editButton" label="&editDirectories.label;"
                    accesskey="&editDirectories.accesskey;"
                    oncommand="onEditDirectories();"/>
          </hbox>
        </radiogroup>

        <separator class="thin"/>

        <hbox pack="end">
          <button id="globalAddressingPrefsLink"
                  label="&globalAddressingPrefs.label;"
                  accesskey="&globalAddressingPrefs.accesskey;"
                  oncommand="showGlobalAddressingPrefs();"/>
        </hbox>
      </html:fieldset>
      </html:div>
    </vbox>

      <!-- Security Tab -->

    <vbox id="e2eEditing">

      <stringbundle id="bundle_e2e" src="chrome://messenger/locale/am-smime.properties"/>
      <stringbundle id="bundle_brand" src="chrome://branding/locale/brand.properties"/>

      <linkset>
        <html:link rel="localization" href="branding/brand.ftl"/>
        <html:link rel="localization" href="messenger/openpgp/openpgp.ftl"/>
      </linkset>

      <vbox flex="1">
        <html:p class="intro-paragraph">&e2eEnc.description;</html:p>
        <html:p class="intro-paragraph"
                data-l10n-id="e2e-intro-description"></html:p>
        <html:span class="tail-with-learn-more"
                   data-l10n-id="e2e-intro-description-more"></html:span>
        <label is="text-link" id="acceptLearnMoreE2E"
               href="https://support.mozilla.org/kb/thunderbird-help-setup-account-e2ee"
               value="&e2eLearnMore.label;"/>
      </vbox>

      <html:div>
        <html:fieldset id="openpgpOptions"
                       aria-describedby="openPgpDescription">
          <html:legend>&openpgpKeys.label;</html:legend>

          <vbox data-subcategory="openpgp" class="openpgp-container">
            <hbox align="center" class="opengpg-intro-section">
              <html:img id="openPgpKey"
                        src="chrome://messenger/skin/icons/new/compact/key.svg"
                        alt="" />
              <vbox flex="1">
                <description class="description-with-side-element openpgp-description">
                  <html:p id="openPgpDescription"></html:p>
                  <html:img id="openPgpStatusImage" class="openpgp-status"
                            alt="" hidden="hidden"/>
                  <html:span id="openPgpSelectionStatus"
                             class="tail-with-learn-more"
                             hidden="hidden"></html:span>
                  <label is="text-link" id="openPgpLearnMore"
                         href="https://support.mozilla.org/kb/introduction-to-e2e-encryption"
                         data-l10n-id="e2e-learn-more"
                         class="learnMore"
                         hidden="true"/>
                </description>
              </vbox>
              <vbox>
                <!-- Please don't remove the wrapping hbox/vbox/box for these elements. It's used to properly compute the search tooltip position. -->
                <hbox>
                  <button id="addOpenPgpButton"
                          data-l10n-id="openpgp-add-key-button"
                          oncommand="openKeyWizard();"
                          class="accessory-button openpgp-add-key-button openpgp-image-btn"
                          flex="1"/>
                </hbox>
              </vbox>
            </hbox>

            <hbox id="openPgpNotification"
                  class="inline-notification-container success-container"
                  collapsed="true">
              <hbox class="inline-notification-wrapper align-center">
                <html:img class="notification-image"
                          src="chrome://global/skin/icons/check.svg"
                          alt="" />
                <description id="openPgpNotificationDescription"/>
                <button class="close-icon" oncommand="closeNotification()"/>
              </hbox>
            </hbox>

            <vbox id="openPgpKeyList">
              <radiogroup id="openPgpKeyListRadio">
                <vbox id="openPgpOptionNone" class="content-blocking-category">
                  <hbox>
                    <radio id="openPgpNone"
                          value=""
                          data-l10n-id="openpgp-radio-none"
                          flex="1"/>
                  </hbox>
                  <vbox class="indent">
                    <description data-l10n-id="openpgp-radio-none-desc"/>
                  </vbox>
                </vbox>
                <!-- All available keys will be appended here. -->
              </radiogroup>
            </vbox>
          </vbox>

          <separator/>

          <description flex="1" data-l10n-id="openpgp-manager-description"/>

          <separator class="thin"/>

          <hbox>
            <button id="openOpenPGPKeyManagerButton"
                    data-l10n-id="openpgp-manager-button"
                    class="first-element"
                    oncommand="openKeyManager()"/>
          </hbox>
        </html:fieldset>
      </html:div>

      <separator/>

      <html:div>
      <html:fieldset id="smimeOptions">
        <html:legend>&certificates2.label;</html:legend>

        <label id="identity_signing_cert_nameLabel"
               value="&signingCert2.message;" control="identity_signing_cert_name"/>

        <hbox align="center" class="input-container">
          <html:input id="identity_signing_cert_name" type="text"
                      class="input-inline"
                      readonly="readonly"
                      disabled="disabled"
                      aria-labelledby="identity_signing_cert_nameLabel"
                      wsm_persist="true"
                      prefstring="mail.identity.%identitykey%.signing_cert_name"/>

          <button id="signingCertSelectButton"
                  label="&digitalSign.certificate.button;"
                  accesskey="&digitalSign.certificate.accesskey;"
                  oncommand="smimeSelectCert('identity_signing_cert_name')"/>

          <button id="signingCertClearButton"
                  label="&digitalSign.certificate_clear.button;"
                  accesskey="&digitalSign.certificate_clear.accesskey;"
                  oncommand="smimeClearCert('identity_signing_cert_name')"/>
        </hbox>

        <separator class="thin"/>

        <label value="&encryptionCert2.message;"
               control="identity_encryption_cert_name"/>

        <hbox align="center" class="input-container">
          <html:input id="identity_encryption_cert_name" type="text"
                      class="input-inline"
                      readonly="readonly"
                      disabled="disabled"
                      wsm_persist="true"
                      prefstring="mail.identity.%identitykey%.encryption_cert_name"/>

          <button id="encryptionCertSelectButton"
                  label="&encryption.certificate.button;"
                  accesskey="&encryption.certificate.accesskey;"
                  oncommand="smimeSelectCert('identity_encryption_cert_name')"/>

          <button id="encryptionCertClearButton"
                  label="&encryption.certificate_clear.button;"
                  accesskey="&encryption.certificate_clear.accesskey;"
                  oncommand="smimeClearCert('identity_encryption_cert_name')"/>
        </hbox>

        <separator class="thin"/>

        <hbox align="right">
          <button id="openCertManagerButton" oncommand="openCertManager();"
                  label="&manageCerts3.label;" accesskey="&manageCerts3.accesskey;"/>
          <button id="openDeviceManagerButton" oncommand="openDeviceManager();"
                  label="&manageDevices2.label;" accesskey="&manageDevices2.accesskey;"/>
        </hbox>

      </html:fieldset>
      </html:div>

      <separator/>

      <html:legend>&sendingDefaults.label;</html:legend>

      <html:div>
      <html:fieldset>
        <radiogroup id="encryptionChoices" class="indent" hidden="true">
          <radio id="disable_encryption" wsm_persist="true" value="0"
                 data-l10n-id="e2e-disable-enc"/>
          <radio id="enable_encryption" wsm_persist="true" value="2"
                 data-l10n-id="e2e-enable-enc"/>
          <hbox>
            <description flex="1" data-l10n-id="e2e-enable-description"
                         class="option-description tip-caption"/>
          </hbox>
        </radiogroup>

        <separator/>

        <description flex="1" data-l10n-id="e2e-signing-description"></description>
        <checkbox id="identity_sign_mail" class="indent" wsm_persist="true"
                  prefstring="mail.identity.%identitykey%.sign_mail"
                  data-l10n-id="e2e-sign-message"/>

      </html:fieldset>
      </html:div>

      <separator/>

      <html:legend data-l10n-id="e2e-advanced-section"/>

      <html:div>
      <html:fieldset>
        <checkbox id="identity_attach_key" wsm_persist="true"
                  prefstring="mail.identity.%identitykey%.attachPgpKey"
                  data-l10n-id="e2e-attach-key"/>

        <checkbox id="identity_autocrypt_headers" wsm_persist="true"
                  prefstring="mail.identity.%identitykey%.sendAutocryptHeaders"
                  data-l10n-id="e2e-autocrypt-headers"/>

        <checkbox id="identity_encrypt_subject" wsm_persist="true"
                  prefstring="mail.identity.%identitykey%.protectSubject"
                  data-l10n-id="e2e-encrypt-subject"/>

        <checkbox id="identity_encrypt_drafts" wsm_persist="true"
                  prefstring="mail.identity.%identitykey%.autoEncryptDrafts"
                  data-l10n-id="e2e-encrypt-drafts"/>

        <separator/>

        <description>&e2eTechPref.description;</description>
        <radiogroup id="technologyChoices" class="indent">
          <radio id="technology_automatic" wsm_persist="true" value="0"
                 label="&technologyAutomatic.label;"/>

          <radio id="technology_prefer_openpgp" wsm_persist="true" value="2"
                 label="&technologyOpenPGP.label;"/>

          <radio id="technology_prefer_smime" wsm_persist="true" value="1"
                 label="&technologySMIME.label;"/>
        </radiogroup>
      </html:fieldset>
      </html:div>
    </vbox>

    </tabpanels>
  </tabbox>
</dialog>
</html:body>
</html>
